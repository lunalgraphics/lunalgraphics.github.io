var Ue=Object.defineProperty;var Ne=(c,l,a)=>l in c?Ue(c,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[l]=a;var Oe=(c,l,a)=>Ne(c,typeof l!="symbol"?l+"":l,a);import{s as $e,d as He,r as Je,o as qe,e as Ve}from"../chunks/scheduler.oDIh-Dkl.js";import{S as Ge,i as Ke,e as r,s as p,t as M,o as Qe,c as o,g as q,f as u,a as b,b as S,d,p as Xe,q as Ye,h as f,m as ee,j as V,k as t,r as Ze,n as ue,l as Le,u as et,v as tt,x as nt,w as lt}from"../chunks/index.BKGjqEok.js";import{e as je}from"../chunks/each.D6YF6ztN.js";import{b as at}from"../chunks/paths.DJ9pjGoB.js";import{b as Ae}from"../chunks/banner.LwrPhY0V.js";import{S as st}from"../chunks/SocialMetadata.tAgCeku3.js";class fe{constructor(l){Oe(this,"contentWindow");this.contentWindow=l}static async createEmbed(l,a){let s="";typeof a=="object"?s=JSON.stringify(a):typeof a=="string"&&(s=a);let e=document.createElement("iframe");return e.style.border="0",e.style.width="100%",e.style.height="100%",a?e.src="https://www.photopea.com#"+encodeURI(s):e.src="https://www.photopea.com",l.appendChild(e),await new Promise(function(h,m){let B=T=>{if(T.source==e.contentWindow&&T.data=="done"){let C=new fe(e.contentWindow);window.removeEventListener("message",B),h(C)}};window.addEventListener("message",B)})}async runScript(l){return await this._pause(),await new Promise((s,e)=>{let _=[],h=m=>{m.source==this.contentWindow&&(_.push(m.data),m.data=="done"&&(window.removeEventListener("message",h),s(_)))};window.addEventListener("message",h),this.contentWindow.postMessage(l,"*")})}async loadAsset(l){return await this._pause(),await new Promise((s,e)=>{let _=[],h=m=>{m.source==this.contentWindow&&(_.push(m.data),m.data=="done"&&(window.removeEventListener("message",h),s(_)))};window.addEventListener("message",h),this.contentWindow.postMessage(l,"*")})}async openFromURL(l,a=!0){await this._pause();let s="done";for(;s=="done";)s=(await this.runScript(`app.echoToOE(${a?"app.activeDocument.layers.length":"app.documents.length"})`))[0];let e=s;for(await this.runScript(`app.open("${l}", null, ${a});`);e==s||e=="done";)e=(await this.runScript(`app.echoToOE(${a?"app.activeDocument.layers.length":"app.documents.length"})`))[0];return["done"]}async exportImage(l="png"){await this._pause();let a="done";for(;a=="done";)a=(await this.runScript(`app.activeDocument.saveToOE("${l}");`))[0];return new Blob([a],{type:"image/"+l})}async _pause(l=10){return await new Promise((a,s)=>{setTimeout(()=>{a()},l)})}}function We(c,l,a){const s=c.slice();return s[10]=l[a].input,s[11]=l[a].output,s[13]=a,s}function Fe(c){let l,a,s,e,_=`[${c[13]}]`,h,m,B,T,C,O=c[10]+"",A,E,I,te="",z,H,w,G,ne=`[${c[13]}]`,K,j,le,W,P,U=JSON.stringify(c[11],null,2)+"",N;return{c(){l=r("tr"),a=r("td"),s=r("pre"),e=M("In "),h=M(_),m=M(":"),B=p(),T=r("td"),C=r("pre"),A=M(O),E=p(),I=r("tr"),I.innerHTML=te,z=r("tr"),H=r("td"),w=r("pre"),G=M("Out "),K=M(ne),j=M(":"),le=p(),W=r("td"),P=r("pre"),N=M(U),this.h()},l(y){l=o(y,"TR",{});var g=b(l);a=o(g,"TD",{class:!0});var ie=b(a);s=o(ie,"PRE",{class:!0});var $=b(s);e=S($,"In "),h=S($,_),m=S($,":"),$.forEach(d),ie.forEach(d),B=u(g),T=o(g,"TD",{class:!0});var R=b(T);C=o(R,"PRE",{class:!0});var Q=b(C);A=S(Q,O),Q.forEach(d),R.forEach(d),g.forEach(d),E=u(y),I=o(y,"TR",{"data-svelte-h":!0}),q(I)!=="svelte-8439at"&&(I.innerHTML=te),z=o(y,"TR",{});var D=b(z);H=o(D,"TD",{class:!0});var F=b(H);w=o(F,"PRE",{class:!0});var k=b(w);G=S(k,"Out "),K=S(k,ne),j=S(k,":"),k.forEach(d),F.forEach(d),le=u(D),W=o(D,"TD",{class:!0});var ae=b(W);P=o(ae,"PRE",{class:!0});var J=b(P);N=S(J,U),J.forEach(d),ae.forEach(d),D.forEach(d),this.h()},h(){f(s,"class","svelte-zd4xln"),f(a,"class","svelte-zd4xln"),ee(a,"width","80px"),f(C,"class","codeEditor svelte-zd4xln"),f(T,"class","svelte-zd4xln"),f(w,"class","svelte-zd4xln"),f(H,"class","svelte-zd4xln"),ee(H,"width","80px"),f(P,"class","svelte-zd4xln"),f(W,"class","svelte-zd4xln")},m(y,g){V(y,l,g),t(l,a),t(a,s),t(s,e),t(s,h),t(s,m),t(l,B),t(l,T),t(T,C),t(C,A),V(y,E,g),V(y,I,g),V(y,z,g),t(z,H),t(H,w),t(w,G),t(w,K),t(w,j),t(z,le),t(z,W),t(W,P),t(P,N)},p(y,g){g&8&&O!==(O=y[10]+"")&&Le(A,O),g&8&&U!==(U=JSON.stringify(y[11],null,2)+"")&&Le(N,U)},d(y){y&&(d(l),d(E),d(I),d(z))}}}function rt(c){let l,a=`<div class="centered"><h1>Photopea Playground</h1> <p>Experiment with the Photopea API<br/>
            Blog Entry 4<br/>
            2024-07-25</p></div>`,s,e,_,h,m="Learn more about the Photopea API",B,T,C,O,A,E,I="Config",te,z,H,w,G,ne,K,j,le="Refresh",W,P,U,N,y,g,ie="Console",$,R,Q,D,F,k,ae,J=`[${c[3].length}]`,de,me,ve,se,L,we,_e,ge,be,Ee,re,Be="If you liked this article, feel free to share it on social media!",ye,xe,Te,Ce,Pe,X,Ie="Back to the blog",he,Y,ce,Re,ze,oe=je(c[3]),x=[];for(let i=0;i<oe.length;i+=1)x[i]=Fe(We(c,oe,i));return Y=new st({props:{title:"Photopea Playground | Blog | Lunal Graphics",desc:"Experiment with the Photopea API.",imgURL:Ae,pageURL:"https://lunalgraphics.com/blog/4",imgAlt:"Photopea"}}),{c(){l=r("div"),l.innerHTML=a,s=p(),e=r("div"),_=M(`Use the following tools to experiment with the Photopea configuration
    and scripting.
    `),h=r("a"),h.textContent=m,B=p(),T=r("br"),C=p(),O=r("br"),A=p(),E=r("h2"),E.textContent=I,te=p(),z=r("br"),H=p(),w=r("pre"),G=p(),ne=r("br"),K=p(),j=r("button"),j.textContent=le,W=p(),P=r("div"),U=p(),N=r("br"),y=p(),g=r("h2"),g.textContent=ie,$=p(),R=r("table");for(let i=0;i<x.length;i+=1)x[i].c();Q=p(),D=r("tr"),F=r("td"),k=r("pre"),ae=M("In "),de=M(J),me=M(":"),ve=p(),se=r("td"),L=r("pre"),we=p(),_e=r("br"),ge=p(),be=r("br"),Ee=p(),re=r("i"),re.textContent=Be,ye=p(),xe=r("br"),Te=p(),Ce=r("br"),Pe=p(),X=r("a"),X.textContent=Ie,he=p(),Qe(Y.$$.fragment),this.h()},l(i){l=o(i,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),q(l)!=="svelte-1u5k3v2"&&(l.innerHTML=a),s=u(i),e=o(i,"DIV",{class:!0});var n=b(e);_=S(n,`Use the following tools to experiment with the Photopea configuration
    and scripting.
    `),h=o(n,"A",{href:!0,target:!0,"data-svelte-h":!0}),q(h)!=="svelte-537qxf"&&(h.textContent=m),B=u(n),T=o(n,"BR",{}),C=u(n),O=o(n,"BR",{}),A=u(n),E=o(n,"H2",{"data-svelte-h":!0}),q(E)!=="svelte-gjvoa4"&&(E.textContent=I),te=u(n),z=o(n,"BR",{}),H=u(n),w=o(n,"PRE",{contenteditable:!0,class:!0,spellcheck:!0}),b(w).forEach(d),G=u(n),ne=o(n,"BR",{}),K=u(n),j=o(n,"BUTTON",{"data-svelte-h":!0}),q(j)!=="svelte-1up5h4y"&&(j.textContent=le),W=u(n),P=o(n,"DIV",{}),b(P).forEach(d),U=u(n),N=o(n,"BR",{}),y=u(n),g=o(n,"H2",{"data-svelte-h":!0}),q(g)!=="svelte-yjr01l"&&(g.textContent=ie),$=u(n),R=o(n,"TABLE",{id:!0,class:!0});var v=b(R);for(let ke=0;ke<x.length;ke+=1)x[ke].l(v);Q=u(v),D=o(v,"TR",{});var Z=b(D);F=o(Z,"TD",{class:!0});var De=b(F);k=o(De,"PRE",{class:!0});var pe=b(k);ae=S(pe,"In "),de=S(pe,J),me=S(pe,":"),pe.forEach(d),De.forEach(d),ve=u(Z),se=o(Z,"TD",{class:!0});var Me=b(se);L=o(Me,"PRE",{contenteditable:!0,class:!0,spellcheck:!0}),b(L).forEach(d),Me.forEach(d),Z.forEach(d),v.forEach(d),we=u(n),_e=o(n,"BR",{}),ge=u(n),be=o(n,"BR",{}),Ee=u(n),re=o(n,"I",{"data-svelte-h":!0}),q(re)!=="svelte-5r453"&&(re.textContent=Be),ye=u(n),xe=o(n,"BR",{}),Te=u(n),Ce=o(n,"BR",{}),Pe=u(n),X=o(n,"A",{href:!0,"data-svelte-h":!0}),q(X)!=="svelte-j6el6n"&&(X.textContent=Ie),n.forEach(d),he=u(i);const Se=Xe("svelte-d850bl",document.head);Ye(Y.$$.fragment,Se),Se.forEach(d),this.h()},h(){f(l,"class","titlesection"),ee(l,"background-image","url("+Ae+")"),f(h,"href","https://www.photopea.com/api/"),f(h,"target","_blank"),f(w,"contenteditable",""),f(w,"class","codeEditor svelte-zd4xln"),f(w,"spellcheck",!1),c[2]===void 0&&He(()=>c[5].call(w)),ee(P,"width","100%"),ee(P,"height","500px"),f(k,"class","svelte-zd4xln"),f(F,"class","svelte-zd4xln"),ee(F,"width","80px"),f(L,"contenteditable",""),f(L,"class","codeEditor svelte-zd4xln"),f(L,"spellcheck",!1),c[4]===void 0&&He(()=>c[9].call(L)),f(se,"class","svelte-zd4xln"),f(R,"id","console"),f(R,"class","svelte-zd4xln"),ee(R,"width","100%"),f(X,"href",at+"/blog"),f(e,"class","infosection"),document.title="Photopea Playground | Blog | Lunal Graphics"},m(i,n){V(i,l,n),V(i,s,n),V(i,e,n),t(e,_),t(e,h),t(e,B),t(e,T),t(e,C),t(e,O),t(e,A),t(e,E),t(e,te),t(e,z),t(e,H),t(e,w),c[2]!==void 0&&(w.innerText=c[2]),t(e,G),t(e,ne),t(e,K),t(e,j),t(e,W),t(e,P),c[7](P),t(e,U),t(e,N),t(e,y),t(e,g),t(e,$),t(e,R);for(let v=0;v<x.length;v+=1)x[v]&&x[v].m(R,null);t(R,Q),t(R,D),t(D,F),t(F,k),t(k,ae),t(k,de),t(k,me),t(D,ve),t(D,se),t(se,L),c[4]!==void 0&&(L.innerText=c[4]),t(e,we),t(e,_e),t(e,ge),t(e,be),t(e,Ee),t(e,re),t(e,ye),t(e,xe),t(e,Te),t(e,Ce),t(e,Pe),t(e,X),V(i,he,n),Ze(Y,document.head,null),ce=!0,Re||(ze=[ue(w,"input",c[5]),ue(j,"click",c[6]),ue(L,"keydown",c[8]),ue(L,"input",c[9])],Re=!0)},p(i,[n]){if(n&4&&i[2]!==w.innerText&&(w.innerText=i[2]),n&8){oe=je(i[3]);let v;for(v=0;v<oe.length;v+=1){const Z=We(i,oe,v);x[v]?x[v].p(Z,n):(x[v]=Fe(Z),x[v].c(),x[v].m(R,Q))}for(;v<x.length;v+=1)x[v].d(1);x.length=oe.length}(!ce||n&8)&&J!==(J=`[${i[3].length}]`)&&Le(de,J),n&16&&i[4]!==L.innerText&&(L.innerText=i[4])},i(i){ce||(et(Y.$$.fragment,i),ce=!0)},o(i){tt(Y.$$.fragment,i),ce=!1},d(i){i&&(d(l),d(s),d(e),d(he)),c[7](null),nt(x,i),lt(Y),Re=!1,Je(ze)}}}function ot(c,l,a){let s,e,_=JSON.stringify({files:[],environment:{theme:3,lang:"en",plugins:[]}},null,4);qe(async()=>{a(1,e=await fe.createEmbed(s,_))});let h=[],m='app.echoToOE("hello world");';function B(){_=this.innerText,a(2,_)}const T=async()=>{a(0,s.innerHTML="",s),a(1,e=await fe.createEmbed(s,_))};function C(E){Ve[E?"unshift":"push"](()=>{s=E,a(0,s)})}const O=async E=>{if(E.key=="Enter"&&!E.shiftKey){E.preventDefault();let I=await e.runScript(m);a(3,h=[...h,{input:m,output:I}]),a(4,m="")}};function A(){m=this.innerText,a(4,m)}return[s,e,_,h,m,B,T,C,O,A]}class mt extends Ge{constructor(l){super(),Ke(this,l,ot,rt,$e,{})}}export{mt as component};
